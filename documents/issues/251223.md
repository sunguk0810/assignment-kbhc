# 이슈 및 궁금증 정리

### 1. [이슈] MySQL 계정 접근 안되는 문제
- 상황 : docker-compose.yml에 `MYSQL_USER`, `MYSQL_PASSWORD`를 넣었음에도 불구하고 DataGrip에서 접속이 안되는 문제 발생
- 원인
  - 최초에 데이터베이스 생성시점에 `MYSQL_USER`, `MYSQL_PASSWORD`가 입력되어 사용자는 생성되지만 `MYSQL_DATABASE`가 입력되지 않아 접근 권한을 부여받지 못함.
- 해결 방법
  - 환경변수에 `MYSQL_DATABASE` 옵션을 추가하여 `kbhc` 사용자가 데이터베이스 접근 권한을 얻게 됨. 
- 참고 문서
  - [Docker Hub - MySQL](https://hub.docker.com/_/mysql)

### 2. [이슈] Spring Data Redis 설정 문제

```yaml
data:
  redis:
    url: 127.0.0.1
    port: 16379
```
***************************
APPLICATION FAILED TO START
***************************

Description:

The URL '127.0.0.1' is not valid for configuring Spring Data Redis. The scheme 'null' is not supported.

Action:

Use the scheme 'redis://' for insecure or 'rediss://' for secure Redis standalone configuration.


https://docs.spring.io/spring-boot/appendix/application-properties/index.html#application-properties.data.spring.data.redis.database
```yaml
data:
  redis:
    host: 127.0.0.1
    port: 16379
```

spring.data.redis.url

Connection URL. Overrides host, port, username, password, and database. Example: redis://user:password@example.com:6379/8

### 3. [이슈] Spring Data JPA Entity 생성시 오류

```sql
create table role
(
    role_id     bigint                                 not null comment '권한 ID (Sequence)',
    created_at  datetime(6)  default CURRENT_TIMESTAMP not null comment '생성일자',
    created_by  varchar(255) default ANONYMOUS comment '생성자',
    updated_at  datetime(6)  default CURRENT_TIMESTAMP not null comment '수정일자',
    updated_by  varchar(255) default ANONYMOUS comment '수정자',
    description varchar(200) comment '설명',
    role_name   varchar(50)                            not null comment '권한 명',
    role_type   enum('ROLE_COMPANY', 'ROLE_USER')      not null comment '권한 유형',
    primary key (role_id)
) comment='사용자 및 회사의 권한 테이블' engine=InnoDB" via JDBC [You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ANONYMOUS comment '생성자',
updated_at datetime(6) default CURRENT_T' at line 4]
```

### 4. [이슈] JPA Constraint 이름 지정
```sql
-- auto-generated definition
create table user
(
    record_key      varchar(255)                          not null comment '사용자 구분키'
primary key,
    created_at      timestamp   default CURRENT_TIMESTAMP not null comment '생성일자',
    created_by      varchar(50) default 'ANONYMOUS'       null comment '생성자',
    updated_at      timestamp   default CURRENT_TIMESTAMP not null comment '수정일자',
    updated_by      varchar(50) default 'ANONYMOUS'       null comment '수정자',
    email           varchar(255)                          not null comment '이메일',
    hashed_password varchar(255)                          not null comment '비밀번호',
    is_active       tinyint(1)  default 1                 not null comment '활성화여부',
    username        varchar(100)                          not null comment '이름',
    constraint UKob8kqyqqgmefl0aco34akdtpe
        unique (email)
)
comment '사용자 테이블';




```