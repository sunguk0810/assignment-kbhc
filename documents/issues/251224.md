# 이슈 및 궁금증 정리

### 1. [궁금증] JPA 연관관계 설정
- 사용자 테이블(users)에서 회사 테이블(companies)의 `company_id`를 참조해서 객체를 가져오기 위해 어떻게 해야하는가?
  - 사용자는 단일의 회사를 가지나, 회사는 사용자와 관계 맺지 않는다.
    - 이 말이 뜻하는 바는 users <-> companies가 1:1 매핑을 맺는다는 것을 의미한다.
    - 그리고 관계는 users > companies 단방향으로 흘러간다.
- 그렇다면 JPA에서 관계 설정 방법 및 방향성을 어떻게 설정할 수 있는가?
  - Entity들간의 관계는 1:1, 1:N, N:1, N:M의 관계를 맺을 수 있다.
    - `1:1` > `@OneToOne`
    - `1:N` > `@OneToMany`
    - `N:1` > `@ManyToOne`
    - `N:M` > `@ManyToMany`
  - 관계는 양방향 (bidirectional) 또는 단방향 (unidirectional)로 맺을 수 있으며 관계의 대상에 따라 owning side / inverse (non-owning) side로 나뉠 수 있다.
  - 참고 문서
    - [Jakarta Persistence Spec](https://jakarta.ee/specifications/persistence/3.2/jakarta-persistence-spec-3.2#a516)
  - 코드 예시 
    ```java
    // User.java
    @Entity
    public class User {
        @Id
        @Column(name = "record_key", comment = "사용자 구분키")
        @GeneratedValue(strategy = GenerationType.UUID)
        private String recordKey;
    
        @OneToOne
        @JoinColumn(name = "company_id", nullable = false)
        private Company company;
    }
    ```
- 용어 보충 설명
  - owning side / inverse (non-owning) side란 무엇인가?
    -  `owning side` = 데이터베이스에서 외래키를 가지고 있는 쪽 (연관관계 주인)
    -  `inverse side` = 외래키를 가지고 있지 않은 반대 쪽 (mappedBy로 mapping 정의)
    - 참고 문서
      - [Java EE 6 Tutorial - Direction in Entity Relationships](https://docs.oracle.com/cd/E19798-01/821-1841/bnbqi/index.html)

### 2. [이슈] JPA 컬럼명 관련 오류 (`@JoinColumn`)
- 상황 : `HealthMeasureSummary`, `HealthMeasureInfo` 클래스에서 `HealthTestItem`의 `item_code` 컬럼 조인하기 위해 참조하고 있는데 
         Hibernate가 `HealthTestItem`의 `item_code` 속성을 찾을 수 없어 애플리케이션 구동 중 오류 발생
- 원인
    - Hibernate는 Entity의 필드명을 DB 컬럼명으로 변환하기 위해 다음과 같은 절차를 거친다.
      - 1. 논리적 명명 전략 (Logical Naming Strategy)
      - 2. 물리적 명명 전략 (Physical Naming Strategy)
    - `@JoinColumn`에서 `referencedColumnName`을 매핑할 떄에는 논리적 이름의 매핑 정보를 가져오기에 `item_code` 속성을 읽을 수 없었다.
- 해결 방법
    - `@Column(name="item_code")`를 명시하는 방법 또는 `@JoinColumn(referencedColumnName="itemCode")`를 입력하는 방법이 있다.
- 참고 문서
    - [[Hibernate] 하이버네이트 명명 전략 (Hibernate Naming Strategy)](https://eoneunal.tistory.com/6)

### 3. [이슈] JPA 테스트 환경 설정 오류
- 오류 2. `not-null property references a null or transient value for entity com.github.sunguk0810.assignment.domain.company.entity.Company.createdAt`
  - 원인 : JpaAudting Import X 
- 